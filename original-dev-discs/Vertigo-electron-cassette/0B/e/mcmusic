		TTL	mc005a		; Takes care of music********************************************************************************note		DFB	&13,0,&FF,0,&FF,0,&FF,0note0		DFB	0,&01,6,0,3,0,&FF,0note1		DFB	1,&01,0,0,&FF,0,&FF,0note2		DFB	2,&00,7,0,&FF,0,&FF,0********************************************************************************setup_main	LDA	#0		STA	main_offset		STA	mb_num		LDA	#>mbar0		STA	main_pointer		LDA	#<mbar0		STA	main_pointer+1		RTS********************************************************************************eomainbar	INC	mb_num		STZ	main_offset		LDX	mb_num		LDA	main_bars,X		CMP	#255		BNE	m_notend		JSR	setup_main		BRA	do_mainm_notend	ASL	A		TAX		LDA	mbars_table,X		STA	main_pointer		LDA	mbars_table+1,X		STA	main_pointer+1********************************************************************************do_main	LDY	main_offset		LDA	(main_pointer),Y		BNE	not_eomain		INY		LDA	(main_pointer),Y		BEQ	eomainbar		DEYnot_eomain	LDA	(main_pointer),Y		CMP	#10				BLT	special_main		STA	note2+4		INY		LDA	(main_pointer),Y		STA	note2+6		LDA	#7		LDX	#>note2		LDY	#<note2		JSR	osword		INC	main_offset		INC	main_offset		RTS********************************************************************************special_main	LDA	#0		STA	note2+2		INY		LDA	(main_pointer),Y		STA	note2+6		LDA	#7		LDX	#>note2		LDY	#<note2		JSR	osword		LDA	#7		STA	note2+2		INC	main_offset		INC	main_offset		RTS********************************************************************************code		LDA	#128		; check channel 1		LDX	#-6		; buffer for free		LDY	#0		; spaces (]X)		JSR	osbyte		CPX	#4		BLT	eobass		JSR	do_bass		BRA	codeeobass		LDA	#128		; check channel 1		LDX	#-7		; buffer for free		LDY	#0		; spaces (]X)		JSR	osbyte		CPX	#4		BLT	eomain		JSR	do_main		BRA	eobasseomain		RTS********************************************************************************init_music	JSR	setup_bass		JSR	setup_main		JSR	music_onoff		LDA	#15		LDX	#0		JSR	osbyte		RTS********************************************************************************setup_bass	LDA	#0		STA	bass_offset		STA	bb_num		LDA	#>bbar8		STA	bass_pointer		LDA	#<bbar8		STA	bass_pointer+1		RTS********************************************************************************eobassbar	INC	bb_num		STZ	bass_offset		LDX	bb_num		LDA	bass_bars,X		CMP	#255		BNE	b_notend		JSR	setup_bass		BRA	do_bassb_notend	ASL	A		TAX		LDA	bbars_table,X		STA	bass_pointer		LDA	bbars_table+1,X		STA	bass_pointer+1********************************************************************************do_bass	LDY	bass_offset		LDA	(bass_pointer),Y		BNE	not_eobass		INY		LDA	(bass_pointer),Y		BEQ	eobassbar		DEYnot_eobass	LDA	(bass_pointer),Y		CMP	#10				BLT	special_bass		SEC		SBC	#6		STA	note1+4cont_bass	INY		LDA	(bass_pointer),Y		STA	note0+6		STA	note1+6sound_bass	LDA	#7		LDX	#>note1		LDY	#<note1		JSR	osword		LDA	#7		LDX	#>note0		LDY	#<note0		JSR	oswordexit_bass	INC	bass_offset		INC	bass_offset		RTS********************************************************************************special_bass	CMP	#4		BNE	sb_not4		LDX	#6		LDY	#7		BRA	fix_basssb_not4	CMP	#5		BNE	sb_not5		LDX	#6		LDY	#3		BRA	fix_basssb_not5	CMP	#6		BNE	sb_not6		LDX	#10		LDY	#3fix_bass	STX	note0+2		STY	note0+4		BRA	exit_basssb_not6	CMP	#1		BNE	sb_not1		LDA	note1+4		PHA		LDA	note0+2		PHA		LDA	#198		LDX	#8		BRA	cont_bass2sb_not1	CMP	#3		BNE	sb_not3		LDA	note1+4		PHA		LDA	note0+2		PHA		LDA	#220		LDX	#8		BRA	cont_bass2sb_not3	CMP	#0		BNE	sb_not0		LDA	note1+4		PHA		LDA	note0+2		PHA		LDA	#190		LDX	#9		BRA	cont_bass2sb_not0	CMP	#2		BNE	sb_not2		LDA	note1+4		PHA		LDA	note0+2		PHA		LDA	#0		LDX	#0cont_bass2	STA	note1+4		STX	note0+2		LDA	#7		STA	note0+4		JSR	cont_bass		LDA	#3		STA	note0+4		PLA		STA	note0+2		PLA		STA	note1+4sb_not2	RTS********************************************************************************envelope3	DFB	3,129,-1,2,0,2,30,0,116,-10,-5,-3,116,106envelope4	DFB	4,1,0,0,0,0,0,0,100,-3,-2,-1,100,80envelope5	DFB	5,0,0,0,0,0,0,0,100,-10,-3,-1,100,30envelope6	DFB	6,1,0,0,0,0,0,0,100,-5,-3,-4,100,60envelope7	DFB	7,1,0,0,0,0,0,0,100,-4,-1,-1,100,80envelope8	DFB	8,1,0,0,0,0,0,0,126,-10,-5,-10,126,66envelope9	DFB	9,1,0,0,0,0,0,0,110,-20,-10,-20,110,50envelope10	DFB	10,1,0,0,0,0,0,0,60,-1,0,-1,60,30********************************************************************************bass_bars	DFB	8,1,1,1,1,5,2,2,2,3,3,6,6,1,1,8,4,4,7,7,9,1,1,1		DFB	0,0,10,10,10,10,255 * * * * * * * * * * * * * * * * * * * *main_bars	DFB	0,1,7,1,7,1,7,1,7,5,2,2,2,3,3,1,7,1,7,1,7,1,7,0		DFB	4,4,6,6,9,1,7,1,7,1,8,0,0,0,0,0,0,255********************************************************************************bbars_table	DW	bbar0,bbar1,bbar2,bbar3,bbar4,bbar5,bbar6		DW	bbar7,bbar8,bbar9,bbar10 * * * * * * * * * * * * * * * * * * * *mbars_table	DW	mbar0,mbar1,mbar2,mbar3,mbar4,mbar5,mbar6		DW	mbar7,mbar8,mbar9********************************************************************************bbar0		DFB	5,0,0,3,0,3,1,3,0,3,0,3,1,5,1,3,0,3,0,3,1,5,3,3		DFB	3,3,4,0,0,0bbar1		DFB	1,5,137,5,137,5,137,5,137,5,137,5,137,5,137,5		DFB	1,5,121,5,121,5,121,5,121,5,121,5,121,5,121,5		DFB	1,5,149,5,149,5,149,5,149,5,149,5,149,5,149,5		DFB	1,5,1,5,129,5,1,5,129,5,129,5,129,5,129,5		DFB	0,0bbar2		DFB	0,10,1,10,0,10,1,10,0,10,1,8,0,2,0,5,0,5,1,5,1,5,0,0bbar3		DFB	109,10,109,10,109,10,109,5,89,5,0,0bbar4		DFB	6,0,137,40,157,40,141,40,129,20,121,20,5,0,0,0bbar5		DFB	129,5,137,5,157,5,149,5,137,5,129,5,137,5,129,5,0,0bbar6		DFB	137,5,137,5,137,10,137,10,137,10,121,5,121,5,121,10		DFB	121,10,1,10,149,5,149,5,149,10,149,10,149,10,129,5		DFB	129,5,129,10,129,10,1,10,0,0bbar7		DFB	1,10,117,10,117,10,117,10,1,10,125,10,125,10,125,10		DFB	1,10,129,10,129,10,129,10,1,10,137,10,137,10,137,10,0,0bbar8		DFB	4,0,255,5,240,5,225,5,210,5,195,5,180,5,155,5,140,5		DFB	5,0,0,0bbar9		DFB	1,10,137,10,137,10,137,10,0,0bbar10		DFB	2,40,0,0 * * * * * * * * * * * * * * * * * * * *mbar0		DFB	0,40,0,0mbar1		DFB	137,5,129,5,121,5,117,5,109,5,101,5,109,5,117,5		DFB	121,10,117,5,109,5,117,10,101,20,137,5,145,5,149,10		DFB	145,5,137,5,129,10,0,0mbar2		DFB	121,5,129,5,149,5,145,10,137,5,129,5,137,10,129,10		DFB	117,10,129,15,0,0mbar3		DFB	109,25,129,5,137,5,145,5,0,0mbar4		DFB	117,20,149,15,137,5,129,10,121,20,129,5,137,5,141,10		DFB	141,20,137,5,141,5,129,20,121,20,0,0mbar5		DFB	165,5,185,5,169,5,165,5,157,5,165,5,149,5,0,5,0,0mbar6		DFB	177,5,165,5,145,5,177,5,165,5,145,5,177,5,165,5		DFB	185,5,165,5,153,5,185,5,165,5,153,5,185,5,165,5		DFB	193,5,177,5,157,5,193,5,177,5,157,5,193,5,177,5		DFB	165,5,153,5,137,5,157,5,153,5,137,5,157,5,153,5,0,0mbar7		DFB	165,10,157,10,149,10,0,0mbar8		DFB	137,5,145,5,149,10,145,10,0,0mbar9		DFB	157,5,153,5,137,5,157,5,153,5,137,5,157,5,153,5,0,0********************************************************************************